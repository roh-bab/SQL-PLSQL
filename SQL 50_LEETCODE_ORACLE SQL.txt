
--1757. Recyclable and Low Fat Products

Select p.product_id from Products p where p.low_fats = 'Y' and p.recyclable = 'Y';

--584 Find Customer Referee

Select name from Customer C where C.referee_id <> 2 or C.referee_id is null;

--595 Big Countries

Select name,population,area from World W where W.area >= 3000000 or W.population >= 25000000;

--1148. Article Views I

Select distinct author_id as id from Views V where V.author_id = V.viewer_id order by id asc;

--1683. Invalid Tweets

Select T.tweet_id from Tweets T where length(T.content) > 15;

--1378. Replace Employee ID With The Unique Identifier

Select Eu.unique_id,E.name from Employees E left join EmployeeUni Eu on E.id = Eu.id;

--1068 Product Sales Analysis 1

Select product_name, year, price from Sales S, Product P where S.product_id = P.product_id;

--1581. Customer Who Visited but Did Not Make Any Transactions

Select V.customer_id,count(1) as count_no_trans from Visits V left join Transactions T on V.visit_id = T.visit_id
 where T.transaction_id is null group by V.customer_id;
 
--197. Rising Temperature

Select id from Weather W where W.temperature > (Select W1.temperature from Weather W1 where W.recordDate = (W1.recordDate+ 1));

--1661. Average Time of Process per Machine

with newtable as (Select machine_id,process_id ,(select sum(timestamp) from activity A2 where a1.machine_id = a2.machine_id and a1.process_id =a2.process_id
and a2.activity_type = 'start' and a1.activity_type=a2.activity_type) start_time
,(select sum(timestamp) from activity A2 where a1.machine_id = a2.machine_id and a1.process_id =a2.process_id
and a2.activity_type = 'end' and a1.activity_type=a2.activity_type) end_time
from activity A1 order by machine_id,process_id,start_time),
onlyStart as (select start_time,process_id,machine_id from newtable where start_time is not null),
onlyEnd as (select end_time,process_id,machine_id from newtable where end_time is not null)

Select onlyStart.machine_id,round(avg(onlyEnd.end_time-onlyStart.start_time),3) processing_time from onlyStart,onlyEnd where onlyStart.machine_id=onlyEnd.machine_id
group by onlyStart.machine_id;

--EXPLAINATION GIVEN IN ATTACHED DOC SQL 50 EXPLAINATION.docs--

--577 EMPLOYEE BONUS

Select name,bonus from (Select E.name,b.bonus from Employee E left join Bonus B on E.empId=B.empId) where bonus <1000 or bonus is null;

1280. Students and Examinations

Select st.student_id student_id,st.student_name student_name ,sub.subject_name subject_name ,count(ex.subject_name) attended_exams  from Students St cross join Subjects Sub left join examinations ex 
on ex.student_id = st.student_id
and sub.subject_name = ex.subject_name
 group by st.student_id,st.student_name,sub.subject_name   order by st.student_id ,sub.subject_name;

570. Managers with at Least 5 Direct Reports

Select name from employee where id in (Select e.id from Employee e ,Employee e1 where e1.managerId = e.Id
group by e.id having count(1)>4);

